{"version":3,"sources":["../../../../server/api/user/user.model.spec.js"],"names":[],"mappings":"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","file":"user.model.spec.js","sourcesContent":["'use strict';\r\n\r\nimport app from '../..';\r\nimport User from './user.model';\r\nvar user;\r\nvar genUser = function() {\r\n  user = new User({\r\n    provider: 'local',\r\n    name: 'Fake User',\r\n    email: 'test@example.com',\r\n    password: 'password'\r\n  });\r\n  return user;\r\n};\r\n\r\ndescribe('User Model', function() {\r\n  before(function() {\r\n    // Clear users before testing\r\n    return User.remove();\r\n  });\r\n\r\n  beforeEach(function() {\r\n    genUser();\r\n  });\r\n\r\n  afterEach(function() {\r\n    return User.remove();\r\n  });\r\n\r\n  it('should begin with no users', function() {\r\n    return User.find({}).exec().should\r\n      .eventually.have.length(0);\r\n  });\r\n\r\n  it('should fail when saving a duplicate user', function() {\r\n    return user.save()\r\n      .then(function() {\r\n        var userDup = genUser();\r\n        return userDup.save();\r\n      }).should.be.rejected;\r\n  });\r\n\r\n  describe('#deafult(related to email validation)', function(){\r\n      it('should have default random usernumber', function(){\r\n        user.save().then(function(u) {\r\n          u.usernumber.should.be.not.empty;\r\n        })\r\n      });\r\n\r\n      it('should have default validation false', function(){\r\n        user.save().then(function(u) {\r\n          u.validation.should.be.eql(false);\r\n        })\r\n      });\r\n\r\n    })\r\n\r\n\r\n  \r\n\r\n  describe('#email', function() {\r\n    it('should fail when saving with a blank email', function() {\r\n      user.email = '';\r\n      return user.save().should.be.rejected;\r\n    });\r\n\r\n    it('should fail when saving with a null email', function() {\r\n      user.email = null;\r\n      return user.save().should.be.rejected;\r\n    });\r\n\r\n    it('should fail when saving without an email', function() {\r\n      user.email = undefined;\r\n      return user.save().should.be.rejected;\r\n    });\r\n\r\n    describe('given user provider is google', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'google';\r\n      });\r\n\r\n      it('should succeed when saving without an email', function() {\r\n        user.email = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n\r\n    describe('given user provider is facebook', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'facebook';\r\n      });\r\n\r\n      it('should succeed when saving without an email', function() {\r\n        user.email = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n\r\n    describe('given user provider is twitter', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'twitter';\r\n      });\r\n\r\n      it('should succeed when saving without an email', function() {\r\n        user.email = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n\r\n    describe('given user provider is github', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'github';\r\n      });\r\n\r\n      it('should succeed when saving without an email', function() {\r\n        user.email = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('#password', function() {\r\n    it('should fail when saving with a blank password', function() {\r\n      user.password = '';\r\n      return user.save().should.be.rejected;\r\n    });\r\n\r\n    it('should fail when saving with a null password', function() {\r\n      user.password = null;\r\n      return user.save().should.be.rejected;\r\n    });\r\n\r\n    it('should fail when saving without a password', function() {\r\n      user.password = undefined;\r\n      return user.save().should.be.rejected;\r\n    });\r\n\r\n    describe('given the user has been previously saved', function() {\r\n      beforeEach(function() {\r\n        return user.save();\r\n      });\r\n\r\n      it('should authenticate user if valid', function() {\r\n        user.authenticate('password').should.be.true;\r\n      });\r\n\r\n      it('should not authenticate user if invalid', function() {\r\n        user.authenticate('blah').should.not.be.true;\r\n      });\r\n\r\n      it('should remain the same hash unless the password is updated', function() {\r\n        user.name = 'Test User';\r\n        return user.save()\r\n          .then(function(u) {\r\n            return u.authenticate('password');\r\n          }).should.eventually.be.true;\r\n      });\r\n    });\r\n\r\n\r\n    \r\n\r\n    describe('given user provider is google', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'google';\r\n      });\r\n\r\n      it('should succeed when saving without a password', function() {\r\n        user.password = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n\r\n    describe('given user provider is facebook', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'facebook';\r\n      });\r\n\r\n      it('should succeed when saving without a password', function() {\r\n        user.password = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n\r\n    describe('given user provider is twitter', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'twitter';\r\n      });\r\n\r\n      it('should succeed when saving without a password', function() {\r\n        user.password = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n\r\n    describe('given user provider is github', function() {\r\n      beforeEach(function() {\r\n        user.provider = 'github';\r\n      });\r\n\r\n      it('should succeed when saving without a password', function() {\r\n        user.password = null;\r\n        return user.save().should.be.fulfilled;\r\n      });\r\n    });\r\n  });\r\n\r\n});\r\n"]}